<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bootstrap Pos-Customer Form</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="stylesheet" href="assets/fonts/css/all.css">
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-utilities.css">
    <link rel="stylesheet" href="assets/normalize.css">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-gradient">
    <div class="container-fluid">
        <a class="navbar-brand text-danger" href="#">Jayawin Pos System</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a  id="home" class="nav-link" aria-current="page" href="#">Home</a>
                </li>
                <li class="nav-item">
                    <a  id="item" class="nav-link" aria-current="page" href="#">Item</a>
                </li>
                <li class="nav-item">
                    <a  id="customer" class="nav-link" href="#">Customer</a>
                </li>
                <li class="nav-item">
                    <a id="order" class="nav-link" href="#">Orders</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Others
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#">Discounts</a></li>
                        <li><a class="dropdown-item" href="#">Careers</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#">About Us</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <form class="d-flex">
        <button type="button" class="btn btn-outline-dark me-2"><i class="fas fa-user-plus"></i> Sign Up</button>
        <button type="button" class="btn btn-outline-dark me-2 "><i class="fas fa-sign-in-alt"></i> Log Out</button>
    </form>
</nav>

<!--DashBoard-->
<div id="db" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
    </div>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="assets/images/image_01.jpg" class="d-block w-100" alt="..." style="height: 660px">
        </div>
        <div class="carousel-item">
            <img src="assets/images/image_02.jpg" class="d-block w-100" alt="..." style="height: 660px">
        </div>
        <div class="carousel-item">
            <img src="assets/images/image_03.jpg" class="d-block w-100" alt="..." style="height: 660px">
        </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
    </button>
</div>
<!--Customer-->
<section id="cu" class="container-fluid bg-light ">
    <div class="row">
        <div class="col pb-4 pt-5">
            <section class="container-fluid bg-gradient">
                <div class="row bg-gradient "><h4>Save Customer</h4></div>
                <div class="row bg-gradient">
                    <form class="mt-4 mb-4 w-100" >
                        <input id="search" class="form-control w-50 col-sm-5 " type="search" placeholder="Search/Delete" aria-label="Search">
                    </form>
                </div>
                <div class="row bg-gradient">
                    <div class="col-3 pb-5">
                        <button id="searchButton" type="button" class="btn bg-success  w-100 m-2">Search</button>
                    </div>
                    <div class="mb-1">
                        <button id="ClearSearch" type="button" class="btn btn-primary ">Clear</button>
                        <button id="DeleteCustomer" type="button" class="btn btn-danger ">Delete</button>
                        <button id="UpdateCustomer" type="button" class="btn btn-secondary ">Update</button>
                    </div>
                </div>
            </section>
        </div>
        <div class="col-6 pt-5">
            <div class="mb-3">
                <label class="form-label" for="txtCustId">Customer ID</label>
                <input class="form-control w-50" id="txtCustId" placeholder="Customer ID" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtCustName">Customer Name</label>
                <input class="form-control w-50" id="txtCustName" placeholder="Customer Name" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtCustAddress">Customer Address</label>
                <input class="form-control w-50" id="txtCustAddress" placeholder="Customer Address" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtCustSalary">Customer Salary</label>
                <input class="form-control w-50" id="txtCustSalary" placeholder="Customer Salary" type="text">
            </div>
            <div class="mb-3">
                <button id="btnSaveOrUpdate" type="button" class="btn btn-primary" >Save</button>
                <button id="clearCustomer" type="button" class="btn btn-outline-primary">Clear</button>
            </div>
        </div>
    </div>

    <div class="row pb-5">
        <table class="table">
            <thead class="table-active">
            <tr>
                <th scope="col">Customer ID</th>
                <th scope="col">Name</th>
                <th scope="col">Address</th>
                <th scope="col">Salary</th>
            </tr>
            </thead>
            <tbody id="customerTable">

            </tbody>
        </table>
    </div>
</section>
<!--Item-->
<section id="it" class="container-fluid bg-light ">
    <div class="row">
        <div class="col pb-9 pt-2">
            <section class="container-fluid bg-gradient pt-3">
                <div class="row w-50 bg-gradient"><h4>Save Item</h4></div>
                <div class="row bg-gradient">
                    <form class="mt-4 mb-4 w-100" >
                        <input id="itemsearch" class="form-control w-50" type="search" placeholder="Search/Delete" aria-label="Search">
                    </form>
                </div>
                <div class="row bg-gradient">
                    <div class="col-6 pb-5">
                        <button id="btnsearchItem" type="button" class="btn bg-success w-100">Search</button>
                    </div>
                    <div class="mb-1">
                        <button id="ClearItem" type="button" class="btn btn-primary ">Clear</button>
                        <button id="DeleteItem" type="button" class="btn btn-danger ">Delete</button>
                        <button id="UpdateItem" type="button" class="btn btn-secondary ">Update</button>
                    </div>
                </div>
            </section>
        </div>
        <div class="col-6 pt-5">
            <div class="mb-3">
                <label class="form-label" for="txtItemId">Item ID</label>
                <input class="form-control w-50" id="txtItemId" placeholder="Item ID" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtItemName">Item Name</label>
                <input class="form-control w-50" id="txtItemName" placeholder="Item Name" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtItemPrice">Item Price</label>
                <input class="form-control w-50" id="txtItemPrice" placeholder="Item Price" type="text">
            </div>
            <div class="mb-3">
                <label class="form-label" for="txtItemQty">Item Qty</label>
                <input class="form-control w-50" id="txtItemQty" placeholder="Item Qty" type="text">
            </div>
            <div class="mb-3">
                <button id="btnsaveItem" type="button" class="btn btn-primary" >Save</button>
                <button id="clear" type="button" class="btn btn-outline-primary">Clear</button>
            </div>
        </div>
    </div>

    <div class="row pb-5">
        <table class="table">
            <thead class="table-active">
            <tr>
                <th scope="col">Item ID</th>
                <th scope="col">Item Name</th>
                <th scope="col">Price</th>
                <th scope="col">Qty</th>
            </tr>
            </thead>
            <tbody id="itemTable">

            </tbody>
        </table>
    </div>
</section>
<!--Orders-->
<section id="or"  class="container-fluid bg-light">

    <section class="row">

        <div class="col bg-gradient m-4 pb-4">


            <section class="container">

                <div class="row">
                    <div class="bg-info mb-3 p-2"><h4>Bill Details</h4></div>
                    <div class="col">
                        <caption>Order ID:</caption>
                        <form>
                            <input id="txtO_Id" class="form-control " type="text">
                        </form>
                    </div>
                    <div class="col">
                        <caption>Order Date:</caption>
                        <form>
                            <input id="txtO_Date" class="form-control " type="text">
                        </form>
                    </div>

                </div>

                <div class="row">
                    <div class="col">
                        <caption>Customer_ID:</caption>
                        <form>
                            <input id="txtC_Id" class="form-control " type="text">
                        </form>
                    </div>

                </div>
                <div class="row">
                    <div class="col">
                        <caption>Name:</caption>
                        <form>
                            <input id="txtC_Name" class="form-control " type="text">
                        </form>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <caption>Address:</caption>
                        <form>
                            <input id="txtC_Address" class="form-control " type="text">
                        </form>
                    </div>
                    <div class="col">
                        <caption>Salary:</caption>
                        <form>
                            <input id="txtC_Salary" class="form-control " type="text">
                        </form>
                    </div>

                </div>

            </section>
        </div>

        <div class="col bg-gradient m-4 pb-4">

            <section class="container">

                <div class="row">
                    <div class="bg-info mb-3 p-2"><h4>Item Details</h4></div>
                    <div class="col">
                        <caption>Item Id:</caption>
                        <form>
                            <input id="txtI_Id" class="form-control " type="text">
                        </form>
                    </div>

                </div>
                <div class="row">
                    <div class="col">
                        <caption>Item Name:</caption>
                        <form>
                            <input id="txtI_Name" class="form-control " type="text">
                        </form>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <caption>Item Price:</caption>
                        <form>
                            <input id="txtI_Price" class="form-control " type="text">
                        </form>
                    </div>
                    <div class="col">
                        <caption>QtyOnH:</caption>
                        <form>
                            <input id="txtI_Qoh" class="form-control " type="text">
                        </form>
                    </div>

                </div>

                <div class="row">
                    <div class="col">
                        <caption>Order QTY:</caption>
                        <form>
                            <input id="txtI_Qty" class="form-control " type="text">
                        </form>
                    </div>
                </div>


                <div class="row">
                    <div class="col">
                        <button id="btnAddItem" class="btn btn-success mt-4">Add Item</button>
                        <button id="btnClearTable" class="btn btn-danger mt-4">Clear Table</button>

                    </div>
                </div>
            </section>
        </div>


        <div class="col bg-gradient m-4 pb-4">
            <div class="row">
                <h4  class="text-secondary">Total </h4>
                <h4 id="lblTotal" class="text-secondary"> </h4>

               <!-- <form>
                    <input id="lblTotal" class="form-control " type="text">
                </form>-->
            </div>


            <section class="container">

                <div class="row">
                    <div class="col">
                        <caption>Payment:</caption>
                        <form>
                            <input id="txtPayment" class="form-control " type="text">
                        </form>
                    </div>
                    <div class="col">
                        <caption>Discount:</caption>
                        <form>
                            <input id="txtDiscount" class="form-control " type="text">
                        </form>
                    </div>
                </div>


                <div class="row">
                    <div CLASS="col">
                        <caption>Balance:</caption>
                        <form>
                            <input id="txtBalance" class="form-control " type="text">
                        </form>
                    </div>
                </div>


                <div class="row">
                    <div class="col">
                        <button id="btnPlaceOrder" class="btn btn-success mt-4">Place Order</button>
                    </div>
                </div>
            </section>
        </div>
    </section>

    <!--Table-->
    <section class="row p-3 mb-5">
        <div class="col">
            <table class="table">
                <thead class="bg-info">
                <tr>
                    <th scope="col">Item ID</th>
                    <th scope="col">Item Name</th>
                    <th scope="col">Qty</th>
                    <th scope="col">Price</th>
                </tr>
                </thead>
                <tbody id="OrderTable">

                </tbody>
            </table>
        </div>

    </section>
</section>

<script src="assets/jQuery/jquery-3.6.0.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="db/db.js"></script>
<script src="controller/CustomerController.js"></script>
<script src="model/CustomerDto.js"></script>
<script src="controller/ItemController.js"></script>
<script src="model/ItemDto.js"></script>
<script src="controller/OrderController.js"></script>
<script src="model/ItemDetailsDto.js"></script>
<script src="controller/OrderDetailsController.js"></script>
<script src="model/OrderDto.js"></script>

<script>
    $("#db").css("display","block");
    $("#cu").css("display","none");
    $("#it").css("display","none");
    $("#or").css("display","none");

    $("#customer").click(function (){
        $("#cu").css("display","block");
        $("#db").css("display","none");
        $("#it").css("display","none");
        $("#or").css("display","none");
        loadallCustomers();

    });
    $("#item").click(function (){
        $("#it").css("display","block");
        $("#cu").css("display","none");
        $("#or").css("display","none");
        $("#db").css("display","none");

        loadallItems();

    });
    $("#order").click(function (){
        $("#or").css("display","block");
        $("#it").css("display","none");
        $("#cu").css("display","none");
        $("#db").css("display","none");
    });
    $("#home").click(function (){
        $("#db").css("display","block");
        $("#it").css("display","none");
        $("#cu").css("display","none");
        $("#or").css("display","none");
    });

    //------------------------Validate Customer--------------------------------------------------
    const cusIDRegEx = /^[C](-00)[0-9]{1,4}$/;
    const cusNameRegEx = /^[A-z0-9 ]{3,}$/;
    const cusAddressRegEx = /^[A-z0-9 ]{3,}$/;
    const cusSalaryRegEx = /^[0-9]+$/;


    $('#txtCusID,#txtCusName,#txtCusAddress,#txtCusSalary').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault(); // stop execution of the button
        }
    });

    $('#txtCusID,#txtCusName,#txtCusAddress,#txtCusSalary').on('blur', function () {
        formValid();
    });

    $("#txtCustId").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkValid();
        }

        if (eventOb.key == "Control") {
            var typedCustomerID = $("#txtCustId").val();
            var srcCustomer = searchCustomer(typedCustomerID);
            $("#txtCustId").val(srcCustomer.getCustomerID());
            $("#txtCustName").val(srcCustomer.getCustomerName());
            $("#txtCustAddress").val(srcCustomer.getCustomerAddress());
            $("#txtCustSalary").val(srcCustomer.getCustomerSalary());
        }

    });

    $("#txtCustName").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkValid();
        }
    });

    $("#txtCustAddress").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkValid();
        }
    });

    $("#txtCustSalary").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkValid();
        }
    });

    $("#btnSaveOrUpdate").attr('disabled', true);

    function Valid() {
        var cusID = $("#txtCustId").val();
        $("#txtCustId").css('border', '2px solid green');
        if (cusIDRegEx.test(cusID)) {
            var cusName = $("#txtCustName").val();
            if (cusNameRegEx.test(cusName)) {
                $("#txtCustName").css('border', '2px solid green');
                var cusAddress = $("#txtCustAddress").val();
                if (cusAddressRegEx.test(cusAddress)) {
                    $("#txtCustAddress").css('border', '2px solid green');
                    var cusSalary = $("#txtCustSalary").val();
                    var resp = cusSalaryRegEx.test(cusSalary);
                    if (resp) {
                        $("#txtCustSalary").css('border', '2px solid green');
                        return true;
                    } else {
                        $("#txtCustSalary").css('border', '2px solid red');
                        return false;
                    }
                } else {
                    $("#txtCustAddress").css('border', '2px solid red');
                    return false;
                }
            } else {
                $("#txtCustName").css('border', '2px solid red');
                return false;
            }
        } else {
            $("#txtCustId").css('border', '2px solid red');
            return false;
        }
    }

    function checkValid() {
        var cusID = $("#txtCustId").val();
        if (cusIDRegEx.test(cusID)) {
            $("#txtCustName").focus();
            var cusName = $("#txtCustName").val();
            if (cusNameRegEx.test(cusName)) {
                $("#txtCustAddress").focus();
                var cusAddress = $("#txtCustAddress").val();
                if (cusAddressRegEx.test(cusAddress)) {
                    $("#txtCustSalary").focus();
                    var cusSalary = $("#txtCustSalary").val();
                    var resp = cusSalaryRegEx.test(cusSalary);
                    if (resp) {
                        let res = confirm("Do you sure to add this Customer..?");
                        if (res) {
                            save();
                            clearAll();
                        }
                    } else {
                        $("#txtCustSalary").focus();
                    }
                } else {
                    $("#txtCustAddress").focus();
                }
            } else {
                $("#txtCustName").focus();
            }
        } else {
            $("#txtCustId").focus();
        }
    }

    function setButton() {
        let b = Valid();
        if (b) {
            $("#btnSaveOrUpdate").attr('disabled', false);
        } else {
            $("#btnSaveOrUpdate").attr('disabled', true);
        }
    }

    //----------------------Customer--------------------------------------------------------------

        $("#btnSaveOrUpdate").click(function () {
            checkValid();
        });
        $("#searchButton").click(function () {
            var searchID = $("#search").val();
            var response = searchCustomer(searchID);
            if (response) {
                $("#txtCustId").val(response.id);
                $("#txtCustName").val(response.name);
                $("#txtCustAddress").val(response.address);
                $("#txtCustSalary").val(response.salary);
            }else{
                clearAll();
                alert("No Customer");
            }
        });
        $("#clearCustomer").click(function () {
        clearAll();
    });
        $("#ClearSearch").click(function () {
            clearAll();
        });
        $("#DeleteCustomer").click(function () {
            var D_id = $("#search").val();
            deleteCustomer(D_id);
            clearAll();
            loadallCustomers();
         });
        $("#UpdateCustomer").click(function () {
            let customerID = $("#txtCustId").val();
            let customerName = $("#txtCustName").val();
            let customerAddress = $("#txtCustAddress").val();
            let customerSalary = $("#txtCustSalary").val();

            var cust=new CustomerDto(customerID,customerName,customerAddress,customerSalary);

            updateCustomer(cust);
        clearAll();
        loadallCustomers();
    });

        function save() {
            let customerID = $("#txtCustId").val();
            let customerName = $("#txtCustName").val();
            let customerAddress = $("#txtCustAddress").val();
            let customerSalary = $("#txtCustSalary").val();

            var customer=new CustomerDto(customerID,customerName,customerAddress,customerSalary);
            saveCustomer(customer);
            loadallCustomers();

        }

    //----------------Validate Item---------------------------------------------------------------
    const itemIdRegEx = /^[I](-00)[0-9]{1,4}$/;
    const itemNameRegEx = /^[A-z ]{4,}$/;
    const itemPriceRegEx = /^[0-9]{1,}[.]?[0-9]{1,2}$/;
    const itemQtyRegEx = /^[0-9]{1,}[.]?[0-9]{1,2}$/;


    $('#txtItemId,#txtItemName,#txtItemPrice,#txtItemQty').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault(); // stop execution of the button
        }
    });

    $("#txtItemId").on('keyup', function (eventOb) {
        setItemButton();
        if (eventOb.key == "Enter") {
            checkItemValid();
        }

        if (eventOb.key == "Control") {
            var typedItemID = $("#txtItemId").val();
            var srcItem = searchItem(typedItemID);
            $("#txtItemId").val(srcItem.getCustomerId());
            $("#txtItemName").val(srcItem.getCustomerName());
            $("#txtItemPrice").val(srcItem.getCustomerAddress());
            $("#txtItemQty").val(srcItem.getCustomerSalary());
        }

    });

    $("#txtItemName").on('keyup', function (eventOb) {
        setItemButton();
        if (eventOb.key == "Enter") {
            checkItemValid();
        }
    });

    $("#txtItemPrice").on('keyup', function (eventOb) {
        setItemButton();
        if (eventOb.key == "Enter") {
            checkItemValid();
        }
    });

    $("#txtItemQty").on('keyup', function (eventOb) {
        setItemButton();
        if (eventOb.key == "Enter") {
            checkItemValid();
        }
    });

    $("#btnsaveItem").attr('disabled', true);

    function ItemValid() {
        var itID = $("#txtItemId").val();
        $("#txtItemId").css('border', '2px solid green');
        if (itemIdRegEx.test(itID)) {
            var itName = $("#txtItemName").val();
            if (itemNameRegEx.test(itName)) {
                $("#txtItemName").css('border', '2px solid green');
                var itprice = $("#txtItemPrice").val();
                if (itemPriceRegEx.test(itprice)) {
                    $("#txtItemPrice").css('border', '2px solid green');
                    var itqty = $("#txtItemQty").val();
                    var resp = itemQtyRegEx.test(itqty);
                    if (resp) {
                        $("#txtItemQty").css('border', '2px solid green');
                        return true;
                    } else {
                        $("#txtItemQty").css('border', '2px solid red');
                        return false;
                    }
                } else {
                    $("#txtItemPrice").css('border', '2px solid red');
                    return false;
                }
            } else {
                $("#txtItemName").css('border', '2px solid red');
                return false;
            }
        } else {
            $("#txtItemId").css('border', '2px solid red');
            return false;
        }
    }

    function checkItemValid() {
        var itID = $("#txtItemId").val();
        if (itemIdRegEx.test(itID)) {
            $("#txtItemName").focus();
            var itname = $("#txtItemName").val();
            if (itemNameRegEx.test(itname)) {
                $("#txtItemPrice").focus();
                var itprice = $("#txtItemPrice").val();
                if (itemPriceRegEx.test(itprice)) {
                    $("#txtItemQty").focus();
                    var itqty = $("#txtItemQty").val();
                    var resp = itemQtyRegEx.test(itqty);
                    if (resp) {
                        let res = confirm("Do you sure to add this Item..?");
                        if (res) {
                            saveitem();
                            clearAllItems();
                        }
                    } else {
                        $("#txtItemQty").focus();
                    }
                } else {
                    $("#txtItemPrice").focus();
                }
            } else {
                $("#txtItemName").focus();
            }
        } else {
            $("#txtItemId").focus();
        }
    }

    function setItemButton() {
        let b = ItemValid();
        if (b) {
            $("#btnsaveItem").attr('disabled', false);
        } else {
            $("#btnsaveItem").attr('disabled', true);
        }
    }



    //---------------Item----------------------------------------------------------------------

            $("#btnsaveItem").click(function () {
                checkItemValid();
            });
            $("#btnsearchItem").click(function () {
                var searchID = $("#itemsearch").val();
                var response = searchItem(searchID);
                if (response) {
                    $("#txtItemId").val(response.id);
                    $("#txtItemName").val(response.name);
                    $("#txtItemPrice").val(response.price);
                    $("#txtItemQty").val(response.qty);
                }else{
                    clearAllItems();
                    alert("No item");
                }
            });
            $("#Clear").click(function () {
                clearAllItems();
            });
            $("#ClearItem").click(function () {
                clearAllItems();
            });
            $("#DeleteItem").click(function () {
                var D_id = $("#itemsearch").val();
                deleteItem(D_id);
                clearAllItems();
                loadallItems();
            });
            $("#UpdateItem").click(function () {
                let itemId = $("#txtItemId").val();
                let itemName = $("#txtItemName").val();
                let itemQty = $("#txtItemQty").val();
                let itemPrice = $("#txtItemPrice").val();

                var item=new ItemDto(itemId,itemName,itemPrice,itemQty);

                updateItem(item);
                clearAllItems();
                loadallItems();
            });

            function saveitem(){
                let itemId = $("#txtItemId").val();
                let itemName = $("#txtItemName").val();
                let itemQty = $("#txtItemQty").val();
                let itemPrice = $("#txtItemPrice").val();

                var item=new ItemDto(itemId,itemName,itemPrice,itemQty);

                saveItem(item);
                loadallItems();
            }

    //-----------Validate Orders------------------------------------------------------------

    const orderIdRegEx=/^[O](-00)[0-9]{1,4}$/;
    const orderDateRegEx=/^(20)[0-9]{2}[-][0-9]{2}[-][0-9]{2}$/;
    const orderqtyRegEx=/^[0-9]{1,}[.]?[0-9]{1,2}$/;
    const pay_Dis_BalRegEx=/^[0-9]{1,}[.]?[0-9]{1,2}$/;


    $('#txtO_Id,#txtO_Date,#txtC_Id,#txtC_Name,#txtC_Address,#txtC_Salary,#txtI_Id,#txtI_Name,#txtI_Price,#txtI_Qoh,#txtI_Qty,#txtPayment,#txtDiscount,#txtBalance').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault();
        }
    });



    $("#txtO_Id").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }

    });

    $("#txtO_Date").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtC_Id").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }

    });

    $("#txtC_Name").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtC_Address").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtC_Salary").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtI_Id").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtI_Name").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtI_Price").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtI_Qoh").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtI_Qty").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtPayment").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtDiscount").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });

    $("#txtBalance").on('keyup', function (eventOb) {
        setorderButton();
        if (eventOb.key == "Enter") {
            checkorderValid();
        }
    });


    $("#btnPlaceOrder").attr('disabled', true);

    function orderValid() {


        var oID = $("#txtO_Id").val();
        $("#txtO_Id").css('border', '2px solid green');
        if (orderIdRegEx.test(oID)) {
            var oDate = $("#txtO_Date").val();
            if (orderDateRegEx.test(oDate)) {
                $("#txtO_Date").css('border', '2px solid green');
                var cId = $("#txtC_Id").val();
                if (cusIDRegEx.test(cId)) {
                    $("#txtC_Id").css('border', '2px solid green');
                    var cname = $("#txtC_Name").val();
                    if (cusNameRegEx.test(cname)) {
                        $("#txtC_Name").css('border', '2px solid green');
                        var cAdd = $("#txtC_Address").val();
                        if (cusAddressRegEx.test(cAdd)) {
                            $("#txtC_Address").css('border', '2px solid green');
                            var cSal = $("#txtC_Salary").val();
                            if (cusSalaryRegEx.test(cSal)) {
                                $("#txtC_Salary").css('border', '2px solid green');
                                var iId = $("#txtI_Id").val();
                                if (itemIdRegEx.test(iId)) {
                                    $("#txtI_Id").css('border', '2px solid green');
                                    var iname = $("#txtI_Name").val();
                                    if (itemNameRegEx.test(iname)) {
                                        $("#txtI_Name").css('border', '2px solid green');
                                        var iprice = $("#txtI_Price").val();
                                        if (itemPriceRegEx.test(iprice)) {
                                            $("#txtI_Price").css('border', '2px solid green');
                                            var iqoh = $("#txtI_Qoh").val();
                                            if (itemQtyRegEx.test(iqoh)) {
                                                $("#txtI_Qoh").css('border', '2px solid green');
                                                var iqty = $("#txtI_Qty").val();
                                                if (orderqtyRegEx.test(iqty)) {
                                                    $("#txtI_Qty").css('border', '2px solid green');
                                                    var opay = $("#txtPayment").val();
                                                    if (pay_Dis_BalRegEx.test(opay)) {
                                                        $("#txtPayment").css('border', '2px solid green');
                                                        var oDis = $("#txtDiscount").val();
                                                        if (pay_Dis_BalRegEx.test(oDis)) {
                                                            $("#txtDiscount").css('border', '2px solid green');
                                                            var obal = $("#txtBalance").val();
                                                            if (pay_Dis_BalRegEx.test(obal)) {
                                                                $("#txtBalance").css('border', '2px solid green');
                                                            } else {
                                                                $("#txtBalance").css('border', '2px solid red');
                                                                return false;
                                                            }
                                                        } else {
                                                            $("#txtDiscount").css('border', '2px solid red');
                                                            return false;
                                                        }
                                                    } else {
                                                        $("#txtPayment").css('border', '2px solid red');
                                                        return false;
                                                    }
                                                } else {
                                                    $("#txtI_Qty").css('border', '2px solid red');
                                                    return false;
                                                }

                                            } else {
                                                $("#txtI_Qoh").css('border', '2px solid red');
                                                return false;
                                            }

                                        } else {
                                            $("#txtI_Price").css('border', '2px solid red');
                                            return false;
                                        }
                                    } else {
                                        $("#txtI_Name").css('border', '2px solid red');
                                        return false;
                                    }
                                } else {
                                    $("#txtI_Id").css('border', '2px solid red');
                                    return false;
                                }
                            } else {
                                $("#txtC_Salary").css('border', '2px solid red');
                                return false;
                            }
                        } else {
                            $("#txtC_Address").css('border', '2px solid red');
                            return false;
                        }
                    } else {
                        $("#txtC_Name").css('border', '2px solid red');
                        return false;
                    }
                } else {
                    $("#txtC_Id").css('border', '2px solid red');
                    return false;
                }
            } else {
                $("#txtO_Date").css('border', '2px solid red');
                return false;
            }
        } else {
            $("#txtO_Id").css('border', '2px solid red');
            return false;
        }
    }

    function checkorderValid() {

        var oID = $("#txtO_Id").val();
        if (orderIdRegEx.test(oID)) {
            $("#txtO_Date").focus();
            var oDate = $("#txtO_Date").val();
            if (orderDateRegEx.test(oDate)) {
                $("#txtC_Id").focus();
                var cId = $("#txtC_Id").val();
                if (cusIDRegEx.test(cId)) {
                    $("#txtC_Name").focus();

                    var cname = $("#txtC_Name").val();
                    if (cusNameRegEx.test(cname)) {
                        $("#txtC_Address").focus();
                        var cAdd = $("#txtC_Address").val();
                        if (cusAddressRegEx.test(cAdd)) {
                            $("#txtC_Salary").focus();
                            var cSal = $("#txtC_Salary").val();
                            if (cusSalaryRegEx.test(cSal)) {

                                $("#txtI_Id").focus();
                                var iId = $("#txtI_Id").val();
                                $("#btnEnterItem").focus();
                                if (itemIdRegEx.test(iId)) {
                                    $("#btnEnterItem").focus();
                                    var iname = $("#txtI_Name").val();
                                    if (itemNameRegEx.test(iname)) {
                                        $("#txtI_Price").focus();
                                        var iprice = $("#txtI_Price").val();
                                        if (itemPriceRegEx.test(iprice)) {
                                            $("#txtI_Qoh").focus();
                                            var iqoh = $("#txtI_Qoh").val();
                                            if (itemQtyRegEx.test(iqoh)) {
                                                $("#txtI_Qty").focus();
                                                var iqty = $("#txtI_Qty").val();
                                                if (orderqtyRegEx.test(iqty)) {
                                                    $("#txtPayment").focus();
                                                    var opay = $("#txtPayment").val();
                                                    if (pay_Dis_BalRegEx.test(opay)) {
                                                        $("#txtDiscount").focus();
                                                        var oDis = $("#txtDiscount").val();
                                                        if (pay_Dis_BalRegEx.test(oDis)) {
                                                            $("#txtBalance").focus();
                                                            var obal = $("#txtBalance").val();
                                                            if (pay_Dis_BalRegEx.test(obal)) {
                                                                let res = confirm("Do you sure to Place this Order..?");
                                                                if (res) {
                                                                    addorder();
                                                                    clearAll();
                                                                }
                                                            } else {
                                                                $("#txtBalance").focus();
                                                            }
                                                        } else {
                                                            $("#txtDiscount").focus();
                                                        }
                                                    } else {
                                                        $("#txtPayment").focus();
                                                    }
                                                } else {
                                                    $("#txtI_Qty").focus();
                                                }
                                            } else {
                                                $("#txtI_Qoh").focus();
                                            }
                                        } else {
                                            $("#txtI_Price").focus();
                                        }
                                    } else {
                                        $("#txtI_Name").focus();
                                    }
                                } else {
                                    $("#txtI_Id").focus();
                                }

                            } else {
                                $("#txtC_Salary").focus();
                            }

                        } else {
                            $("#txtC_Address").focus();
                        }
                    } else {
                        $("#txtC_Name").focus();
                    }
                } else {
                    $("#txtC_Id").focus();
                }
            } else {
                $("#txtO_Date").focus();
            }
        } else {
            $("#txtO_Id").focus();
        }

    }

    function setorderButton() {
        let b = orderValid();
        if (b) {
            $("#btnPlaceOrder").attr('disabled', false);
        } else {
            $("#btnPlaceOrder").attr('disabled', true);
        }
    }

    //----------------Orders-----------------------------------------------------------------

    $("#txtC_Id").on('keyup', function (eventOb) {
        if (eventOb.key == "Enter") {
            var searchID = $("#txtC_Id").val();
            var response = searchCustomer(searchID);
            if (response) {
                $("#txtC_Name").val(response.name);
                $("#txtC_Address").val(response.address);
                $("#txtC_Salary").val(response.salary);
            }else{
                clearAll();
                alert("Wrong Customer Id.");
            }
        }
    });
    $("#txtI_Id").on('keyup', function (eventOb) {
        if (eventOb.key == "Enter") {
            var searchID = $("#txtI_Id").val();
            var response = searchItem(searchID);
            if (response) {
                $("#txtI_Name").val(response.name);
                $("#txtI_Price").val(response.price);
                $("#txtI_Qoh").val(response.qty);
            }else{
                clearAll();
                alert("Wrong Item Id.");
            }
        }
    });
    let total=0;
    $("#btnAddItem").click(function () {
        let orderId=$("#txtO_Id").val();
        let itemId = $("#txtI_Id").val();
        let itemName = $("#txtI_Name").val();
        let qty = $("#txtI_Qty").val();
        let qoh=$("#txtI_Qoh").val();
        let price=(($("#txtI_Price").val())*(qty));

        var itemdetails=new ItemDetailsDto(orderId,itemId,itemName,qty,qoh,price);

        itemList.push(itemdetails);
        loadtabledata(itemdetails);

       total+= price;
        $("#lblTotal").text(total);
    });
    $("#btnClearTable").click(function () {
        $("#OrderTable").remove();
        $("#lblTotal").text("");

    });
    $("#txtDiscount").keyup(function () {
        let payment = $("#txtPayment").val();
        let discount = $("#txtDiscount").val();
        let price=total-discount;
        $("#txtBalance").val(payment-price);
    });
    $("#btnPlaceOrder").click(function () {
        checkorderValid();
    });

    function addorder() {
        let orderId=$("#txtO_Id").val();
        let date=$("#txtO_Date")
        let custid=$("#txtC_Id").val();

        var order=new OrderDto(orderId,date,custid,total);
        placeOrder(order);
        updateqty(itemList);
        AddOrder(itemList);

        itemList.splice(0,itemList.length);
        clearAll();
        clear();
        $("#OrderTable").remove();
    }



</script>

<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>


</body>
</html>